<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>3D Room Project</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; }
    </style>
</head>
<body>
    <div id="ui-container">
    <div class="info-panel">
        <h1>3D Room Viewer</h1>
        <p>ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã® <strong>1, 2, 3, 4</strong> ã¾ãŸã¯<br>ä¸‹ã®ãƒœã‚¿ãƒ³ã§æ™‚é–“å¸¯ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã¾ã™ã€‚</p>
        
        <div class="button-group">
            <button id="btn-morning" class="time-btn">ğŸŒ… Morning</button>
            <button id="btn-noon" class="time-btn">â˜€ï¸ Noon</button>
            <button id="btn-evening" class="time-btn">ğŸŒ‡ Evening</button>
            <button id="btn-night" class="time-btn">ğŸŒ™ Night</button>
        </div>

        <hr class="separator">
        <div class="audio-group">
            <p>BGM Control</p>
            <button id="btn-music" class="music-btn">ğŸ”‡ Play Music</button>

            <div style="margin-top: 10px; display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 12px;">Vol</span>
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="0.3" style="width: 100%;">
            </div>
        </div>
        

        <hr class="separator">
        <div class="view-group">
            <p>View Control</p>
            <div class="button-group">
                <button id="btn-rotate" class="time-btn">ğŸ”„ Rotate</button>
                <button id="btn-reset" class="time-btn">ğŸ“ Reset</button>
            </div>
        </div>
    </div>
</div>

<style>
    /* UIå…¨ä½“ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    #ui-container {
        position: absolute;
        top: 20px;
        left: 20px;
        z-index: 100; /* 3Dã‚­ãƒ£ãƒ³ãƒã‚¹ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
        font-family: 'Helvetica Neue', Arial, sans-serif;
        color: #fff;
        pointer-events: none; /* UIä»¥å¤–ã®å ´æ‰€ã¯3Dæ“ä½œã‚’é€šã™ */
    }

    /* ãƒ‘ãƒãƒ«ã®ãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆã™ã‚Šã‚¬ãƒ©ã‚¹é¢¨ï¼‰ */
    .info-panel {
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(10px);
        padding: 20px;
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        pointer-events: auto; /* ãƒœã‚¿ãƒ³ãªã©ã¯ã‚¯ãƒªãƒƒã‚¯ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ */
        max-width: 280px;
    }

    h1 {
        margin: 0 0 10px 0;
        font-size: 18px;
        font-weight: 700;
        letter-spacing: 1px;
    }

    p {
        margin: 0 0 20px 0;
        font-size: 13px;
        line-height: 1.5;
        color: #ddd;
    }

    /* ãƒœã‚¿ãƒ³ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
    .button-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
    }

    .time-btn {
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        padding: 8px;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 12px;
    }

    .time-btn:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
    }

    .time-btn:active {
        transform: translateY(0);
    }

    /* â˜…è¿½åŠ : åŒºåˆ‡ã‚Šç·š */
    .separator {
        border: 0;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        margin: 15px 0;
    }

    /* â˜…è¿½åŠ : éŸ³æ¥½ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ— */
    .audio-group p {
        margin-bottom: 8px;
        font-weight: bold;
        color: #aaa;
    }

    /* â˜…è¿½åŠ : éŸ³æ¥½ãƒœã‚¿ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .music-btn {
        width: 100%;
        background: rgba(255, 80, 80, 0.2); /* åœæ­¢ä¸­ã¯å°‘ã—èµ¤ã£ã½ã */
        border: 1px solid rgba(255, 255, 255, 0.2);
        color: #fff;
        padding: 10px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.3s ease;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
    }

    .music-btn:hover {
        background: rgba(255, 255, 255, 0.3);
    }

    /* å†ç”Ÿä¸­ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆJSã§ã‚¯ãƒ©ã‚¹ã‚’ä»˜ã‘æ›¿ãˆï¼‰ */
    .music-btn.playing {
        background: rgba(80, 255, 120, 0.2); /* å†ç”Ÿä¸­ã¯ç·‘ã£ã½ã */
        border-color: #4f8;
    }
</style>
    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@latest/build/three.module.js",
            "three/examples/jsm/loaders/GLTFLoader": "https://unpkg.com/three@latest/examples/jsm/loaders/GLTFLoader.js",
            "three/examples/jsm/controls/OrbitControls": "https://unpkg.com/three@latest/examples/jsm/controls/OrbitControls.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader';
        import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls';
        //è¿½åŠ 
        import { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';

        // ==========================================
        // 1. ã‚·ãƒ¼ãƒ³ãƒ»ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãƒ»ã‚«ãƒ¡ãƒ©ã®åŸºæœ¬è¨­å®š
        // ==========================================
        const scene = new THREE.Scene();

        
        // =======
        // 1.5 èƒŒæ™¯è‰²ã®ä»£ã‚ã‚Šã«ã€å…¨å¤©çƒç”»åƒã‚’è¨­å®š
        const textureLoader = new THREE.TextureLoader();
        // ç”»åƒã®ãƒ‘ã‚¹ã‚’æŒ‡å®š
        const texture = textureLoader.load('./background.png'); 
        // å…¨å¤©çƒã¨ã—ã¦ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹è¨­å®š
        texture.mapping = THREE.EquirectangularReflectionMapping; 
        // è‰²ç©ºé–“ã®è¨­å®š
        texture.colorSpace = THREE.SRGBColorSpace;
        scene.background = texture;
        //scene.background = new THREE.Color(0x000000); // èƒŒæ™¯è‰²ï¼ˆæš—ã„ã‚°ãƒ¬ãƒ¼ï¼‰
        // =======


        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        // æ˜ã‚‹ã•ã®è£œæ­£ï¼ˆBlenderã®è‰²å‘³ã«è¿‘ã¥ã‘ã‚‹è¨­å®šï¼‰
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.shadowMap.enabled = true; // ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã§å½±ã‚’è¨±å¯
        document.body.appendChild(renderer.domElement);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.set(7, 7, 7); // ã‚«ãƒ¡ãƒ©ã®åˆæœŸä½ç½®

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true; // æ“ä½œã«æ»‘ã‚‰ã‹ãªæ…£æ€§ã‚’ã¤ã‘ã‚‹

        //ä¸ŠåŠåˆ†ã®ã¿ã‚«ãƒ¡ãƒ©ãŒå‹•ãã‚ˆã†ã«è¨­å®š
        controls.maxPolarAngle = Math.PI / 2 - 0.05;
        //é ãã¾ã§ã‚«ãƒ¡ãƒ©ãŒè¡Œãéããªã„ã‚ˆã†ã«è¨­å®š
        controls.maxDistance = 100;

        // ==========================================
        // 2. ç…§æ˜è¨­å®š
        // ==========================================
        
        // --- ç’°å¢ƒå…‰ ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.4);
        scene.add(ambientLight);

        // --- å¤ªé™½å…‰ (DirectionalLight) ---
        const sunLight = new THREE.DirectionalLight(0xffffff, 1.0);
        sunLight.position.set(0, 10, -8);
        sunLight.castShadow = true; 
        sunLight.shadow.camera.left = -10;
        sunLight.shadow.camera.right = 10;
        sunLight.shadow.camera.top = 10;
        sunLight.shadow.camera.bottom = -10;
        scene.add(sunLight);

        const helper_sun = new THREE.DirectionalLightHelper(sunLight, 5);
        scene.add(helper_sun);

        // --- å¤©äº•ã‹ã‚‰ã®ç‚¹å…‰æº (pointLight) ---
        const pointLight = new THREE.PointLight(0xffffff, 1.5, 50, 1.2);
        pointLight.position.set(0, 2, 0);
        pointLight.castShadow = true;
        pointLight.shadow.mapSize.width = 1024;
        pointLight.shadow.mapSize.height = 1024;
        pointLight.shadow.bias = -0.005;
        scene.add(pointLight);

        const helper = new THREE.PointLightHelper(pointLight);
        scene.add(helper);

        // --- ãƒ©ãƒ³ãƒ—ã®æ˜ã‹ã‚Š (Lamp) ---
        const Lamp = new THREE.PointLight(0xFFD580, 1, 100);
        Lamp.position.set(-1.53, 1.3, 1); 
        Lamp.castShadow = true; 
        Lamp.shadow.camera.left = -10;
        Lamp.shadow.camera.right = 10;
        Lamp.shadow.camera.top = 10;
        Lamp.shadow.camera.bottom = -10;
        scene.add(Lamp);    

        const helper_lamp = new THREE.PointLightHelper(Lamp);
        scene.add(helper_lamp);

        // ==========================================
        // æ™‚é–“å¸¯åˆ‡ã‚Šæ›¿ãˆé–¢æ•°ã®å®šç¾©
        // ==========================================
        function updateScene(time) {
            // å…¨ã¦ã®ãƒ©ã‚¤ãƒˆã‚’ä¸€æ—¦ã‚ªãƒ•ã«è¿‘ã„çŠ¶æ…‹ã«ã™ã‚‹
            sunLight.intensity = 0;
            pointLight.intensity = 0;
            Lamp.intensity = 0;
            ambientLight.intensity = 0.1; 

            switch(time) {
                case 'morning':
                    console.log("æœã®ã‚·ãƒ¼ãƒ³");
                    sunLight.intensity = 0.8;
                    sunLight.color.setHex(0xFFF4E0);
                    sunLight.position.set(-10, 5, -8); 
                    ambientLight.intensity = 0.4;
                    break;

                case 'noon':
                    console.log("æ˜¼ã®ã‚·ãƒ¼ãƒ³");
                    sunLight.intensity = 1.2;
                    sunLight.color.setHex(0xffffff); 
                    sunLight.position.set(0, 10, -10); 
                    ambientLight.intensity = 0.6;
                    break;

                case 'evening':
                    console.log("å¤•æ–¹ã®ã‚·ãƒ¼ãƒ³");
                    sunLight.intensity = 1.0;
                    sunLight.color.setHex(0xFF8C00);
                    sunLight.position.set(10, 5, -5);
                    Lamp.intensity = 1.5;
                    ambientLight.intensity = 0.3;
                    break;

                case 'night':
                    console.log("å¤œã®ã‚·ãƒ¼ãƒ³");
                    pointLight.intensity = 1.8;
                    pointLight.distance = 50;
                    pointLight.decay = 1.0;
                    Lamp.intensity = 1.2;
                    ambientLight.intensity = 0.1; 
                    break;
            }

            // ãƒ˜ãƒ«ãƒ‘ãƒ¼ã‚’æœ€æ–°ã®ä½ç½®ã«æ›´æ–°
            helper_sun.update();
            helper.update();
            helper_lamp.update();
        }

        // --- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å…¥åŠ›ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ ---
        window.addEventListener('keydown', (event) => {
            switch (event.key) {
                case '1': updateScene('morning'); break;
                case '2': updateScene('noon'); break;
                case '3': updateScene('evening'); break;
                case '4': updateScene('night'); break;
            }
        });

        // â˜…è¿½åŠ : UIãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.getElementById('btn-morning').addEventListener('click', () => updateScene('morning'));
        document.getElementById('btn-noon').addEventListener('click', () => updateScene('noon'));
        document.getElementById('btn-evening').addEventListener('click', () => updateScene('evening'));
        document.getElementById('btn-night').addEventListener('click', () => updateScene('night'));

        // ==========================================
        // â˜…è¿½åŠ : éŸ³æ¥½æ©Ÿèƒ½ã®å®Ÿè£…
        // ==========================================
        
        // 1. Audioã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ (ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã¯é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„)
        const bgm = new Audio('Gymnopedies.mp3'); 
        
        // 2. ãƒ«ãƒ¼ãƒ—è¨­å®š (JavaScriptã§ãƒ«ãƒ¼ãƒ—ã‚’å®Ÿè£…)
        bgm.loop = true; 
        
        // 3. éŸ³é‡è¨­å®š (0.0 ã€œ 1.0) ã„ããªã‚Šçˆ†éŸ³ã«ãªã‚‰ãªã„ã‚ˆã†æ§ãˆã‚ã«
        bgm.volume = 0.3; 

        const volumeSlider = document.getElementById('volume-slider');

        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’å‹•ã‹ã—ãŸã¨ãã«éŸ³é‡ã‚’å¤‰æ›´ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆ
        volumeSlider.addEventListener('input', (event) => {
            const volumeValue = event.target.value;
            bgm.volume = volumeValue; // éŸ³å£°ã‚’å¤‰æ›´
        });

        // 4. ãƒœã‚¿ãƒ³ã®è¦ç´ ã‚’å–å¾—
        const musicBtn = document.getElementById('btn-music');
        let isPlaying = false; // ç¾åœ¨å†ç”Ÿã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°

        // 5. ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
        musicBtn.addEventListener('click', () => {
            if (isPlaying) {
                // å†ç”Ÿä¸­ãªã‚‰ -> åœæ­¢ï¼ˆä¸€æ™‚åœæ­¢ï¼‰ã™ã‚‹
                bgm.pause();
                musicBtn.innerHTML = 'ğŸ”‡ Play Music'; // ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›´
                musicBtn.classList.remove('playing'); // ã‚¹ã‚¿ã‚¤ãƒ«æˆ»ã™
                isPlaying = false;
            } else {
                // åœæ­¢ä¸­ãªã‚‰ -> å†ç”Ÿã™ã‚‹
                // â€»ãƒ–ãƒ©ã‚¦ã‚¶ã®ä»•æ§˜ä¸Šã€éŸ³å£°å†ç”Ÿã«ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ(ã‚¯ãƒªãƒƒã‚¯ç­‰)ãŒå¿…é ˆã§ã™
                bgm.play().then(() => {
                    musicBtn.innerHTML = 'ğŸ”Š Stop Music'; // ãƒ†ã‚­ã‚¹ãƒˆå¤‰æ›´
                    musicBtn.classList.add('playing'); // ã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´
                    isPlaying = true;
                }).catch(error => {
                    console.error("å†ç”Ÿã‚¨ãƒ©ãƒ¼:", error);
                });
            }
        });

        // ==========================================
        // â˜…è¿½åŠ : ãƒ“ãƒ¥ãƒ¼æ“ä½œæ©Ÿèƒ½ã®å®Ÿè£…
        // ==========================================

        // --- 1. è‡ªå‹•å›è»¢ (Rotate) ---
        const btnRotate = document.getElementById('btn-rotate');
        controls.autoRotate = false; // åˆæœŸå€¤ã¯åœæ­¢
        controls.autoRotateSpeed = 2.0; // å›è»¢é€Ÿåº¦

        btnRotate.addEventListener('click', () => {
            controls.autoRotate = !controls.autoRotate; // True/Falseã‚’åè»¢
            
            if (controls.autoRotate) {
                btnRotate.style.background = "rgba(80, 255, 120, 0.2)"; // ONã®è‰²
                btnRotate.style.borderColor = "#4f8";
            } else {
                btnRotate.style.background = ""; // å…ƒã®è‰²ã«æˆ»ã™
                btnRotate.style.borderColor = "";
            }
        });

        // --- 2. ã‚«ãƒ¡ãƒ©ãƒªã‚»ãƒƒãƒˆ (Reset) ---
        document.getElementById('btn-reset').addEventListener('click', () => {
            // ã‚«ãƒ¡ãƒ©ä½ç½®ã‚’åˆæœŸä½ç½®ã«æˆ»ã™
            camera.position.set(7, 7, 7);
            // ã‚«ãƒ¡ãƒ©ãŒè¦‹ã‚‹ä¸­å¿ƒç‚¹ã‚‚ãƒªã‚»ãƒƒãƒˆ (0,0,0ã‚’è¦‹ã‚‹)
            controls.target.set(0, 0, 0);
            controls.update();
        });

        // ==========================================
        // 2.5 åœ°é¢ã®ä½œæˆï¼ˆä¸¸ã¿ã‚’å¸¯ã³ãŸåœ°çƒï¼‰
        // ==========================================
        
        // åœ°çƒã®åŠå¾„
        const earthRadius = 1000; 

        // çƒä½“ã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªï¼ˆåŠå¾„, æ¨ªç¸¦ã®åˆ†å‰²æ•°ï¼Œã€€çƒã®è¨ˆç®—ç¯„å›²etcï¼‰
        const earthGeometry = new THREE.SphereGeometry(
            earthRadius, 
            64, 
            64,
            0, 
            Math.PI * 2, 
            0, 
            Math.PI * 0.25
        );

        // åœ°é¢ã®ãƒãƒ†ãƒªã‚¢ãƒ«ï¼ˆè‰²ã‚„è³ªæ„Ÿï¼‰
        const earthMaterial = new THREE.MeshStandardMaterial({ 
            color: 0x55aa55, // ç·‘è‰²ï¼ˆè‰ã®è‰²ï¼‰
            roughness: 0.9,  
            metalness: 0.0   
        });

        const earth = new THREE.Mesh(earthGeometry, earthMaterial);

        // ä½ç½®ã®èª¿æ•´ï¼ˆçƒã®åŠå¾„åˆ†ã ã‘ä¸‹ã’ã‚‹ã€‚2cmã»ã©è¿½åŠ ã§ä¸‹ã’ã€ã´ã£ãŸã‚Šé‡ãªã‚‰ãªã„ã‚ˆã†ã«ã™ã‚‹ã€‚ï¼‰
        earth.position.y = -earthRadius - 0.02;

        // å½±ã‚’å—ã‘ã‚‹è¨­å®š
        earth.receiveShadow = true;

        scene.add(earth);

        // ==========================================
        // 3. ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿
        // ==========================================
        const loader = new GLTFLoader();

        // â˜…è¿½åŠ : Dracoãƒ­ãƒ¼ãƒ€ãƒ¼ã®è¨­å®š
        const dracoLoader = new DRACOLoader();
        // ãƒ‡ã‚³ãƒ¼ãƒ€ãƒ¼ï¼ˆè§£å‡ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã®å ´æ‰€ã‚’æŒ‡å®šï¼ˆWebä¸Šã®CDNã‚’æŒ‡å®šï¼‰
        dracoLoader.setDecoderPath('https://unpkg.com/three@0.160.0/examples/jsm/libs/draco/');
        // GLTFLoaderã«Dracoãƒ­ãƒ¼ãƒ€ãƒ¼ã‚’ç´ä»˜ã‘ã‚‹
        loader.setDRACOLoader(dracoLoader);

        // èª­ã¿è¾¼ã¿ãŸã„ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’æŒ‡å®š
        const modelPath = './furnitureCenter.glb'; 
        
        loader.load(
            modelPath,
            (gltf) => {
                const room = gltf.scene;
                
                // å¿…è¦ã§ã‚ã‚Œã°ã“ã“ã§ä½ç½®ã‚„å‘ãã‚’èª¿æ•´
                room.position.set(0, 0, 0);
                // å½±ã®è¨­å®š 
                room.traverse((node) => {
                    if (node.isMesh) {
                        node.castShadow = true;
                        node.receiveShadow = true;
                    }
                });
                scene.add(room);
                console.log("ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ã¾ã—ãŸ:", modelPath);
            },
            (xhr) => {
                console.log((xhr.loaded / xhr.total * 100) + '% èª­ã¿è¾¼ã¿ä¸­');
            },
            (error) => {
                console.error("èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:", error);
            }
        );

        const modelPath2 = './furnitureNearWall.glb'; 
        
        loader.load(
            modelPath2,
            (gltf) => {
                const room = gltf.scene;
                
                // å¿…è¦ã§ã‚ã‚Œã°ã“ã“ã§ä½ç½®ã‚„å‘ãã‚’èª¿æ•´
                room.position.set(0, 0, 0);
                // å½±ã®è¨­å®š 
                room.traverse((node) => {
                    if (node.isMesh) {
                        node.castShadow = true;
                        node.receiveShadow = true;
                    }
                });
                scene.add(room);
                console.log("ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ã¾ã—ãŸ:", modelPath);
            },
            (xhr) => {
                console.log((xhr.loaded / xhr.total * 100) + '% èª­ã¿è¾¼ã¿ä¸­');
            },
            (error) => {
                console.error("èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:", error);
            }
        );

        const modelPath3 = './room.glb'; 
        
        loader.load(
            modelPath3,
            (gltf) => {
                const room = gltf.scene;
                
                // å¿…è¦ã§ã‚ã‚Œã°ã“ã“ã§ä½ç½®ã‚„å‘ãã‚’èª¿æ•´
                room.position.set(0, 0, 0); 
                // å½±ã®è¨­å®š
                room.traverse((node) => {
                    if (node.isMesh) {
                        node.castShadow = true;
                        node.receiveShadow = true;
                    }
                });
                scene.add(room);
                console.log("ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿ãŒå®Œäº†ã—ã¾ã—ãŸ:", modelPath2);
            },
            (xhr) => {
                console.log((xhr.loaded / xhr.total * 100) + '% èª­ã¿è¾¼ã¿ä¸­');
            },
            (error) => {
                console.error("èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:", error);
            }
        );

        
        // ==========================================
        // 4. ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
        // ==========================================
        function animate() {
            requestAnimationFrame(animate);
            controls.update();
            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        animate();
    </script>
</body>
</html>